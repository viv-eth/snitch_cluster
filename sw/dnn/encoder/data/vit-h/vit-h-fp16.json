// Copyright 2024 ETH Zurich and University of Bologna.
// Licensed under the Apache License, Version 2.0, see LICENSE for details.
// SPDX-License-Identifier: Apache-2.0

{
    num_layers : 32,
    mha: {
        num_heads: 16,
        layernorm: {
            input_dim: {
                batch_size: 1,
                seq_len: 197,
                embeddings: 1280
            },
            eps: 1e-5,
            prec: "FP16",
            n_tiles: 8,
            implementation: "OPT"
        },
        gemm: {
            setup_ssr: 1,
            parallelize_m: 0,
            parallelize_k: 0,
            m_tiles: 25,
            n_tiles: 1,
            k_tiles: 10,
            load_a: 1,
            load_b: 1,
            load_c: 0,
            transa: false,
            transb: true,
            M: 197,
            N: 64,
            K: 1280,
            alpha: 1,
            beta: 0,
            gemm_fp: "gemm_fp16_opt"
        },
        flashattention_2: {
            L: 197,
            S: 197,
            d: 80,
            B_r: 32,
            B_c: 32,
            dtype: "FP16",
            use_mask: false,
            baseline: false
        },
        'fused_concat_linear': {
            num_inputs: 16,
            input_shape: [16, 80],
            output_shape: [16, 128],
            dtype: "FP16",
            gemm_implementation: "gemm_fp16_opt"
        }
    },
    mlp: {
        layernorm: {
            input_dim: {
                batch_size: 1,
                seq_len: 197,
                embeddings: 1280
            },
            eps: 1e-5,
            prec: "FP16",
            n_tiles: 8,
            implementation: "OPT"
        },
        'fused_linear_gelu': {
            setup_ssr: 1,
            parallelize_m: 0,
            parallelize_k: 0,
            m_tiles: 25, // number of tiles in M dimension
            n_tiles: 1, // number of tiles in N dimension
            k_tiles: 8, // number of tiles in K dimension
            load_a: 1,
            load_b: 1,
            load_c: 1,
            transa: false,
            transb: true, // must be true for SIMD
            M: 197,
            N: 64,
            K: 1280,
            alpha: 1,
            beta: 0,
            gemm_fp: "gemm_fp16_opt"
        },
        gemm: {
            setup_ssr: 1,
            parallelize_m: 0,
            parallelize_k: 0,
            m_tiles: 25,
            n_tiles: 30,
            k_tiles: 20,
            load_a: 1,
            load_b: 1,
            load_c: 0,
            transa: false,
            transb: true,
            M: 197,
            N: 1280,
            K: 5120,
            alpha: 1,
            beta: 0,
            gemm_fp: "gemm_fp16_opt"
        }
    }
}